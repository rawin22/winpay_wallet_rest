@*
    WowDash - ASP.Net Core 8 & Bootstrap Admin Dashboard Multipurpose Template design by Parv Infotech
*@
@inject Wallet.Services.LanguageService LanguageService
@{
    // Pull the user’s preferred language out of the claims
    var currentLangClaim = User?.FindFirst("PreferredLanguage")?.Value ?? "en_US";
    var currentLanguage = currentLangClaim.Split('_')[0];
    var lastName = User?.FindFirst("lastName")?.Value ?? "No lastName found";
    var email = User?.FindFirst(System.Security.Claims.ClaimTypes.Email)?.Value ?? "No email found";
    var userName = User?.FindFirst(System.Security.Claims.ClaimTypes.Name)?.Value ?? "Guest";
    //  var userProfileImage = "/images/auth/avatar.jpg";

    // For the flag code, consider just the first two letters (e.g., "en"), or adapt logic
    // to your own approach
    var flagCode = currentLangClaim.StartsWith("en") ? "us" : currentLangClaim.Split('_')[0];


    // Get the list of languages from the service
    var languages = LanguageService.Languages;
}
<div class="navbar-header">
    <div class="row align-items-center justify-content-between">
        <div class="col-auto">
            <div class="d-flex flex-wrap align-items-center gap-4">
                <button type="button" class="sidebar-toggle">
                    <iconify-icon icon="heroicons:bars-3-solid" class="icon text-2xl non-active"></iconify-icon>
                    <iconify-icon icon="iconoir:arrow-right" class="icon text-2xl active"></iconify-icon>
                </button>
                <button type="button" class="sidebar-mobile-toggle">
                    <iconify-icon icon="heroicons:bars-3-solid" class="icon"></iconify-icon>
                </button>
                <form class="navbar-search">
                    <input type="text" name="search" placeholder="Search">
                    <iconify-icon icon="ion:search-outline" class="icon"></iconify-icon>
                </form>
            </div>
        </div>

        <div class="col-auto">
            <div class="d-flex flex-wrap align-items-center gap-3">
                <!-- Language dropdown -->
                <button type="button" data-theme-toggle class="w-40-px h-40-px bg-neutral-200 rounded-circle d-flex justify-content-center align-items-center"></button>

                @* <div class="dropdown d-none d-sm-inline-block"> *@
                @*     <button class="has-indicator w-40-px h-40-px bg-neutral-200 rounded-circle d-flex justify-content-center align-items-center" type="button" data-bs-toggle="dropdown"> *@
                @*         <span class="@($"fi fi-{flagCode}")"></span> *@
                @*     </button> *@
                @*     <div class="dropdown-menu to-top dropdown-menu-sm"> *@
                @*         <div class="py-12 px-16 radius-8 bg-primary-50 mb-16 d-flex align-items-center justify-content-between gap-2"> *@
                @*             <h6 class="text-lg text-primary-light fw-semibold mb-0">Choose Your Language</h6> *@
                @*         </div> *@
                @*         <div class="max-h-400-px overflow-y-auto scroll-sm pe-8"> *@
                @*             @foreach (var language in languages) *@
                @*             { *@
                @*                 <div class="form-check style-check d-flex align-items-center justify-content-between mb-16"> *@
                @*                     <label class="form-check-label line-height-1 fw-medium text-secondary-light" for="english"> *@
                @*                         <span class="text-black hover-bg-transparent hover-text-primary d-flex align-items-center gap-3"> *@
                @*                             <span class="@($"fi fi-{(language.FlagCode == "en" ? "us" : language.FlagCode)}") w-36-px h-36-px flex-shrink-0"></span> *@
                @*                             <span class="text-sm fw-semibold mb-0"> @language.Name </span> *@
                @*                         </span> *@
                @*                     </label> *@
                @*                     <input class="form-check-input" type="radio" name="crypto" id="english"> *@
                @*                 </div> *@
                @*             } *@
                @*         </div> *@
                @*     </div> *@
                @* </div> *@
                <!-- User profile -->
                <div class="dropdown">
                    @* RHU START *@

                    <button class="d-flex justify-content-center align-items-center rounded-circle bg-transparent border-0 p-0" type="button" data-bs-toggle="dropdown">
                        <span class="w-40-px h-40-px bg-primary-subtle text-primary d-inline-flex justify-content-center align-items-center rounded-circle">
                            <i class="ri-user-3-fill text-xl"></i>
                        </span>
                    </button>
                    <div class="dropdown-menu to-top dropdown-menu-sm">
                        <div class="py-12 px-16 radius-8 bg-primary-50 mb-16 d-flex align-items-center justify-content-between gap-2">
                            <div>
                                <h6 class="text-lg text-primary-light fw-semibold mb-2">@userName</h6>
                                <span class="text-secondary-light fw-medium text-sm">@email</span>
                            </div>
                        </div>
                        <ul class="to-top-list">
                            <li>
                                <a class="dropdown-item text-black px-0 py-8 hover-bg-transparent hover-text-primary d-flex align-items-center gap-3" href="/UserProfile/Profile">
                                    <iconify-icon icon="solar:user-linear" class="icon text-xl"></iconify-icon> My Profile
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-black px-0 py-8 hover-bg-transparent hover-text-primary d-flex align-items-center gap-3" href="/UserProfile/LiquidationPreferences">
                                    <iconify-icon icon="tabler:arrows-exchange" class="icon text-xl"></iconify-icon> Liquidation Preferences
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-black px-0 py-8 hover-bg-transparent hover-text-primary d-flex align-items-center gap-3" href="/UserProfile/CurrencySettings">
                                    <iconify-icon icon="tabler:world" class="icon text-xl"></iconify-icon> Currency Settings
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-black px-0 py-8 hover-bg-transparent hover-text-primary d-flex align-items-center gap-3" href="/UserProfile/PasswordChange">
                                    <iconify-icon icon="icon-park-outline:lock" class="icon text-xl"></iconify-icon> Change Password
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-black px-0 py-8 hover-bg-transparent hover-text-primary d-flex align-items-center gap-3" href="/UserProfile/PasswordReset">
                                    <iconify-icon icon="icon-park-outline:lock" class="icon text-xl"></iconify-icon> Reset Password
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-black px-0 py-8 hover-bg-transparent hover-text-primary d-flex align-items-center gap-3" href="/">
                                    <iconify-icon icon="mage:email" class="icon text-xl"></iconify-icon> Contact Us
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-black px-0 py-8 hover-bg-transparent hover-text-danger d-flex align-items-center gap-3" href="~/auth/logout">
                                    <iconify-icon icon="lucide:power" class="icon text-xl"></iconify-icon> Log Out
                                </a>
                            </li>
                        </ul>
                    </div>
                    @* RHU END Profile dropdown end *@
                </div>
            </div>
        </div>
    </div>
</div>

